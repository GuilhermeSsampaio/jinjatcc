import {{ entity.name_pascal }} from "../entidades/{{ entity.name_kebab }}";

export default class Servicos{{ entity.name_pascal }} {
  static async listar(request, response) {
    try {
      const itens = await {{ entity.name_pascal }}.find();
      return response.json(itens);
    } catch (erro) {
      return response
        .status(500)
        .json({ mensagem: "Erro ao listar registros", detalhe: erro.message });
    }
  }

  static async buscarPorId(request, response) {
    try {
      const item = await {{ entity.name_pascal }}.findOne(request.params.id);
      if (!item) {
        return response
          .status(404)
          .json({ mensagem: "Registro nao encontrado" });
      }
      return response.json(item);
    } catch (erro) {
      return response
        .status(500)
        .json({ mensagem: "Erro ao buscar registro", detalhe: erro.message });
    }
  }

  static async criar(request, response) {
    try {
      const dados = request.body;
      const novo = {{ entity.name_pascal }}.create(dados);
      const salvo = await {{ entity.name_pascal }}.save(novo);
      return response.status(201).json(salvo);
    } catch (erro) {
      return response
        .status(500)
        .json({ mensagem: "Erro ao criar registro", detalhe: erro.message });
    }
  }

  static async atualizar(request, response) {
    try {
      const { id } = request.params;
      const dados = request.body;
      const existente = await {{ entity.name_pascal }}.findOne(id);
      if (!existente) {
        return response
          .status(404)
          .json({ mensagem: "Registro nao encontrado" });
      }
      const atualizado = {{ entity.name_pascal }}.merge(existente, dados);
      const salvo = await {{ entity.name_pascal }}.save(atualizado);
      return response.json(salvo);
    } catch (erro) {
      return response
        .status(500)
        .json({
          mensagem: "Erro ao atualizar registro",
          detalhe: erro.message,
        });
    }
  }

  static async remover(request, response) {
    try {
      const { id } = request.params;
      const existente = await {{ entity.name_pascal }}.findOne(id);
      if (!existente) {
        return response
          .status(404)
          .json({ mensagem: "Registro nao encontrado" });
      }
      await {{ entity.name_pascal }}.remove(existente);
      return response.status(204).send();
    } catch (erro) {
      return response
        .status(500)
        .json({ mensagem: "Erro ao remover registro", detalhe: erro.message });
    }
  }
}
